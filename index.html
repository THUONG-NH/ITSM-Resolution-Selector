<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Comprehensive ITSM Resolution Selector</title>
    <style>
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      @keyframes pulse {
        0% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.05);
        }
        100% {
          transform: scale(1);
        }
      }

      @keyframes slideIn {
        from {
          transform: translateX(-100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }

      body {
        font-family: Arial, sans-serif;
        max-width: 1000px;
        margin: 0 auto;
        padding: 20px;
        line-height: 1.6;
        background-color: #f4f4f4;
      }
      .container {
        background-color: white;
        padding: 30px;
        border-radius: 8px;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        animation: fadeIn 0.8s ease-out;
      }
      h1 {
        text-align: center;
        color: #2c3e50;
        font-size: 2.5em;
        animation: pulse 2s infinite;
        background: linear-gradient(45deg, #3498db, #2980b9);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }
      h2 {
        color: #34495e;
        border-bottom: 3px solid #3498db;
        padding-bottom: 10px;
        animation: slideIn 0.6s ease-out;
      }
      .form-section {
        margin-bottom: 20px;
        border-bottom: 1px solid #eee;
        padding-bottom: 20px;
        transition: all 0.3s ease;
      }
      .form-section:hover {
        background-color: #f9f9f9;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }
      .form-group {
        margin-bottom: 15px;
        animation: fadeIn 0.5s ease-out;
      }
      label {
        display: block;
        margin-bottom: 5px;
        font-weight: bold;
        color: #2c3e50;
      }
      select,
      textarea {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        transition: all 0.3s ease;
      }
      select:focus,
      textarea:focus {
        border-color: #3498db;
        box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
      }
      #resolution-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        animation: slideIn 0.7s ease-out;
      }
      #resolution-table th,
      #resolution-table td {
        border: 1px solid #ddd;
        padding: 10px;
        text-align: left;
        transition: background-color 0.3s ease;
      }
      #resolution-table tr:hover {
        background-color: #f1f1f1;
      }
      .action-buttons {
        display: flex;
        justify-content: space-between;
        margin-top: 20px;
      }
      button {
        padding: 10px 15px;
        background-color: #3498db;
        color: white;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        transition: all 0.3s ease;
        animation: fadeIn 0.6s ease-out;
      }
      button:hover {
        background-color: #2980b9;
        transform: translateY(-3px);
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      button.secondary {
        background-color: #95a5a6;
      }
      button.secondary:hover {
        background-color: #7f8c8d;
      }
      .edit-mode select,
      .edit-mode textarea {
        background-color: #eaf2ff;
        border: 2px dashed #3498db;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>ITSM Resolution Selector</h1>

      <div class="form-section">
        <h2>1. Service Category</h2>
        <div class="form-group">
          <label>Service Type</label>
          <select id="service-type">
            <option value="">Select Service Type</option>
            <option value="hardware">Hardware Support</option>
            <option value="software">Software Support</option>
            <option value="network">Network Support</option>
            <option value="access">Access Management</option>
            <option value="email">Email Services</option>
            <option value="security">Security Incident</option>
          </select>
        </div>
      </div>

      <div class="form-section">
        <h2>2. Problem Details</h2>
        <div class="form-group">
          <label>Problem Category</label>
          <select id="problem-category">
            <option value="">Select Problem Category</option>
          </select>
        </div>
        <div class="form-group">
          <label>Specific Issue</label>
          <select id="specific-issue">
            <option value="">Select Specific Issue</option>
          </select>
        </div>
        <div class="form-group">
          <label>Detailed Description</label>
          <textarea
            id="problem-description"
            rows="3"
            placeholder="Provide additional context about the issue"
          ></textarea>
        </div>
      </div>

      <div class="form-section">
        <h2>3. Resolution Steps</h2>
        <div class="form-group">
          <label>Diagnostic Actions</label>
          <select id="diagnostic-actions" multiple>
            <option value="">Select Diagnostic Actions</option>
          </select>
        </div>
        <div class="form-group">
          <label>Resolution Actions</label>
          <select id="resolution-actions" multiple>
            <option value="">Select Resolution Actions</option>
          </select>
        </div>
        <div class="form-group">
          <label>Additional Resolution Notes</label>
          <textarea
            id="resolution-notes"
            rows="3"
            placeholder="Any additional steps or context"
          ></textarea>
        </div>
      </div>

      <div class="form-section">
        <h2>4. Final Result</h2>
        <div class="form-group">
          <label>Resolution Status</label>
          <select id="resolution-status">
            <option value="resolved">Fully Resolved</option>
            <option value="partial">Partially Resolved</option>
            <option value="escalated">Escalated</option>
            <option value="pending">Pending Further Action</option>
          </select>
        </div>
        <div class="form-group">
          <label>Final Outcome</label>
          <textarea
            id="final-outcome"
            rows="3"
            placeholder="Describe the final result of the resolution"
          ></textarea>
        </div>
      </div>

      <div class="action-buttons">
        <button id="generate-resolution">Generate Resolution</button>
        <button id="copy-resolution" class="secondary">Copy Resolution</button>
      </div>

      <table id="resolution-table" style="display: none">
        <thead>
          <tr>
            <th>Field</th>
            <th>Value</th>
          </tr>
        </thead>
        <tbody id="resolution-body">
          <!-- Resolution details will be populated here -->
        </tbody>
      </table>
    </div>

    <script>
      // Comprehensive resolution data
      const resolutionData = {
        hardware: {
          categories: {
            desktop: [
              "Hiệu suất chậm",
              "Màn hình xanh",
              "Không khởi động được",
              "Lỗi phần cứng",
              "Máy tự động tắt",
              "Lỗi ổ cứng",
            ],
            laptop: [
              "Vấn đề pin",
              "Lỗi màn hình",
              "Lỗi bàn phím",
              "Quá nhiệt",
              "Máy treo không phản hồi",
              "Lỗi quạt tản nhiệt",
            ],
            printer: [
              "Kẹt giấy",
              "Chất lượng in kém",
              "Kết nối mạng",
              "Không nhận diện được thiết bị",
              "Máy in không hoạt động",
              "Lỗi hộp mực",
            ],
          },
          diagnosticActions: {
            desktop: [
              "Kiểm tra kết nối nguồn",
              "Chạy công cụ chẩn đoán",
              "Kiểm tra RAM",
              "Kiểm tra cáp kết nối",
              "Kiểm tra nhiệt độ CPU",
              "Chạy kiểm tra ổ cứng",
            ],
            laptop: [
              "Kiểm tra pin",
              "Kiểm tra kết nối màn hình",
              "Chụp ảnh nhiệt",
              "Kiểm tra linh kiện",
              "Vệ sinh quạt tản nhiệt",
              "Chạy kiểm tra phần cứng",
            ],
            printer: [
              "Làm sạch đầu in",
              "Kiểm tra mực/Toner",
              "Chẩn đoán mạng",
              "Kiểm tra đường dẫn giấy",
              "Khởi động lại máy in",
              "Kiểm tra lỗi hộp mực",
            ],
          },
          resolutionActions: {
            desktop: [
              "Khởi động lại máy tính",
              "Cập nhật driver",
              "Thay thế linh kiện",
              "Cài lại hệ điều hành",
              "Nâng cấp RAM",
              "Thay ổ cứng",
            ],
            laptop: [
              "Thay pin",
              "Hàn lại mainboard",
              "Thay màn hình",
              "Làm sạch hệ thống tản nhiệt",
              "Thay quạt làm mát",
              "Thay ổ cứng SSD",
            ],
            printer: [
              "Căn chỉnh lại đầu in",
              "Thay hộp mực",
              "Cài đặt lại mạng",
              "Cập nhật firmware",
              "Thay trống in",
              "Vệ sinh đầu phun",
            ],
          },
        },
        software: {
          categories: {
            office: [
              "Lỗi cài đặt",
              "Vấn đề bản quyền",
              "Hiệu suất",
              "Tương thích",
              "Không thể mở file",
              "Lỗi macro trong Excel",
            ],
            custom: [
              "Lỗi ứng dụng",
              "Vấn đề tích hợp",
              "Cấu hình",
              "Lỗi truy cập",
              "Xung đột phần mềm",
              "Ứng dụng bị treo",
            ],
          },
          diagnosticActions: {
            office: [
              "Kiểm tra phiên bản",
              "Xác minh bản quyền",
              "Giám sát hiệu suất",
              "Kiểm tra tương thích",
              "Kiểm tra quyền file",
              "Chạy ở chế độ an toàn",
            ],
            custom: [
              "Phân tích nhật ký lỗi",
              "Kiểm tra tương thích hệ thống",
              "Kiểm tra cấu hình",
              "Kiểm tra nhật ký truy cập",
              "Chạy kiểm tra bộ nhớ",
              "Tắt bớt tiến trình chạy nền",
            ],
          },
          resolutionActions: {
            office: [
              "Cài đặt lại phần mềm",
              "Cập nhật bản quyền",
              "Tối ưu hiệu suất",
              "Cập nhật bản vá tương thích",
              "Mở file bằng trình đọc khác",
              "Vô hiệu hóa macro",
            ],
            custom: [
              "Cập nhật bản vá ứng dụng",
              "Cấu hình lại tích hợp",
              "Đặt lại cấu hình",
              "Điều chỉnh quyền truy cập",
              "Khởi động lại dịch vụ nền",
              "Tăng tài nguyên hệ thống",
            ],
          },
        },
        network: {
          categories: {
            slow: ["Mạng chậm", "Lỗi DNS", "Tốc độ tải xuống kém", "Ping cao"],
            disconnect: [
              "Rớt mạng",
              "Không kết nối được Wi-Fi",
              "Lỗi cấu hình mạng",
              "Không thể truy cập VPN",
            ],
          },
          diagnosticActions: {
            slow: [
              "Kiểm tra tốc độ mạng",
              "Phân tích lưu lượng",
              "Kiểm tra tín hiệu Wi-Fi",
              "Kiểm tra cấu hình DNS",
            ],
            disconnect: [
              "Kiểm tra địa chỉ IP",
              "Chẩn đoán cáp mạng",
              "Kiểm tra router/switch",
              "Xem nhật ký kết nối",
            ],
          },
          resolutionActions: {
            slow: [
              "Nâng cấp băng thông",
              "Điều chỉnh QoS",
              "Cập nhật firmware router",
              "Chuyển đổi sang mạng có dây",
            ],
            disconnect: [
              "Đặt lại router",
              "Thay đổi kênh Wi-Fi",
              "Cấu hình lại DNS",
              "Thiết lập lại IP",
            ],
          },
        },
        access: {
          categories: {
            login: [
              "Quên mật khẩu",
              "Tài khoản bị khóa",
              "Không thể đăng nhập",
              "Lỗi xác thực hai yếu tố",
            ],
            permissions: [
              "Sai quyền hạn",
              "Không thể truy cập thư mục",
              "Yêu cầu quyền quản trị",
              "Vấn đề nhóm người dùng",
            ],
          },
          diagnosticActions: {
            login: [
              "Xác minh danh tính người dùng",
              "Kiểm tra trạng thái tài khoản",
              "Kiểm tra hệ thống xác thực",
              "Kiểm tra nhật ký đăng nhập",
            ],
            permissions: [
              "Kiểm tra quyền thư mục",
              "Xem lịch sử thay đổi quyền",
              "Kiểm tra chính sách nhóm",
              "Phân tích lỗi truy cập",
            ],
          },
          resolutionActions: {
            login: [
              "Đặt lại mật khẩu",
              "Mở khóa tài khoản",
              "Cấu hình lại xác thực hai yếu tố",
              "Cấp quyền truy cập tạm thời",
            ],
            permissions: [
              "Cập nhật quyền thư mục",
              "Thêm vào nhóm người dùng phù hợp",
              "Chỉnh sửa chính sách truy cập",
              "Tạo vai trò truy cập mới",
            ],
          },
        },
      };
      // Dynamic population of dropdowns
      const serviceTypeSelect = document.getElementById("service-type");
      const problemCategorySelect = document.getElementById("problem-category");
      const specificIssueSelect = document.getElementById("specific-issue");
      const diagnosticActionsSelect =
        document.getElementById("diagnostic-actions");
      const resolutionActionsSelect =
        document.getElementById("resolution-actions");

      serviceTypeSelect.addEventListener("change", function () {
        const serviceType = this.value;

        // Reset subsequent dropdowns
        problemCategorySelect.innerHTML =
          '<option value="">Select Problem Category</option>';
        specificIssueSelect.innerHTML =
          '<option value="">Select Specific Issue</option>';
        diagnosticActionsSelect.innerHTML =
          '<option value="">Select Diagnostic Actions</option>';
        resolutionActionsSelect.innerHTML =
          '<option value="">Select Resolution Actions</option>';

        if (serviceType && resolutionData[serviceType]) {
          // Populate problem categories
          Object.keys(resolutionData[serviceType].categories).forEach(
            (category) => {
              const option = document.createElement("option");
              option.value = category;
              option.textContent =
                category.charAt(0).toUpperCase() + category.slice(1);
              problemCategorySelect.appendChild(option);
            }
          );
        }
      });

      problemCategorySelect.addEventListener("change", function () {
        const serviceType = serviceTypeSelect.value;
        const problemCategory = this.value;

        // Reset subsequent dropdowns
        specificIssueSelect.innerHTML =
          '<option value="">Select Specific Issue</option>';
        diagnosticActionsSelect.innerHTML =
          '<option value="">Select Diagnostic Actions</option>';
        resolutionActionsSelect.innerHTML =
          '<option value="">Select Resolution Actions</option>';

        if (serviceType && problemCategory) {
          // Populate specific issues
          resolutionData[serviceType].categories[problemCategory].forEach(
            (issue) => {
              const option = document.createElement("option");
              option.value = issue;
              option.textContent = issue;
              specificIssueSelect.appendChild(option);
            }
          );

          // Populate diagnostic actions
          resolutionData[serviceType].diagnosticActions[
            problemCategory
          ].forEach((action) => {
            const option = document.createElement("option");
            option.value = action;
            option.textContent = action;
            diagnosticActionsSelect.appendChild(option);
          });

          // Populate resolution actions
          resolutionData[serviceType].resolutionActions[
            problemCategory
          ].forEach((action) => {
            const option = document.createElement("option");
            option.value = action;
            option.textContent = action;
            resolutionActionsSelect.appendChild(option);
          });
        }
      });

      // Generate Resolution
      document
        .getElementById("generate-resolution")
        .addEventListener("click", function () {
          const resolutionBody = document.getElementById("resolution-body");
          const resolutionTable = document.getElementById("resolution-table");

          // Clear previous entries
          resolutionBody.innerHTML = "";

          // Collect form data
          const fields = [
            {
              label: "Service Type",
              value:
                serviceTypeSelect.options[serviceTypeSelect.selectedIndex].text,
            },
            {
              label: "Problem Category",
              value:
                problemCategorySelect.options[
                  problemCategorySelect.selectedIndex
                ].text,
            },
            {
              label: "Specific Issue",
              value:
                specificIssueSelect.options[specificIssueSelect.selectedIndex]
                  .text,
            },
            {
              label: "Problem Description",
              value: document.getElementById("problem-description").value,
            },
            {
              label: "Diagnostic Actions",
              value: Array.from(diagnosticActionsSelect.selectedOptions)
                .map((option) => option.text)
                .join(", "),
            },
            {
              label: "Resolution Actions",
              value: Array.from(resolutionActionsSelect.selectedOptions)
                .map((option) => option.text)
                .join(", "),
            },
            {
              label: "Resolution Notes",
              value: document.getElementById("resolution-notes").value,
            },
            {
              label: "Resolution Status",
              value:
                document.getElementById("resolution-status").options[
                  document.getElementById("resolution-status").selectedIndex
                ].text,
            },
            {
              label: "Final Outcome",
              value: document.getElementById("final-outcome").value,
            },
          ];

          // Populate table
          fields.forEach((field) => {
            if (
              field.value &&
              field.value !== "Select Problem Category" &&
              field.value !== "Select Specific Issue"
            ) {
              const row = resolutionBody.insertRow();
              const labelCell = row.insertCell(0);
              const valueCell = row.insertCell(1);
              labelCell.textContent = field.label;
              valueCell.textContent = field.value;
            }
          });

          // Show table
          resolutionTable.style.display = "table";
        });

      // Copy Resolution
      document
        .getElementById("copy-resolution")
        .addEventListener("click", function () {
          const resolutionTable = document.getElementById("resolution-table");
          const range = document.createRange();
          range.selectNode(resolutionTable);
          window.getSelection().removeAllRanges();
          window.getSelection().addRange(range);

          try {
            document.execCommand("copy");
            alert("Resolution copied to clipboard!");
          } catch (err) {
            console.error("Unable to copy", err);
          }

          window.getSelection().removeAllRanges();
        });

      document
        .getElementById("edit-toggle")
        .addEventListener("click", function () {
          const formSections = document.querySelectorAll(
            ".form-section select, .form-section textarea"
          );
          const isEditable = document.body.classList.toggle("edit-mode");

          formSections.forEach((element) => {
            element.disabled = !isEditable;
          });

          this.textContent = isEditable ? "Save" : "Edit";
        });
    </script>
  </body>
</html>
