<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Comprehensive ITSM Resolution Selector</title>
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
  <link rel="manifest" href="/images/site.webmanifest">
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-1Z88JF3Q1K"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag("js", new Date());

    gtag("config", "G-1Z88JF3Q1K");
  </script>
  <style>
    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes pulse {
      0% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }

      100% {
        transform: scale(1);
      }
    }

    @keyframes slideIn {
      from {
        transform: translateX(-100%);
        opacity: 0;
      }

      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    body {
      font-family: Arial, sans-serif;
      max-width: 1000px;
      margin: 0 auto;
      padding: 20px;
      line-height: 1.6;
      background-color: #f4f4f4;
    }

    .container {
      background-color: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      animation: fadeIn 0.8s ease-out;
    }

    h1 {
      text-align: center;
      color: #2c3e50;
      font-size: 2.5em;
      animation: pulse 2s infinite;
      background: linear-gradient(45deg, #3498db, #2980b9);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    h2 {
      color: #34495e;
      border-bottom: 3px solid #3498db;
      padding-bottom: 10px;
      animation: slideIn 0.6s ease-out;
    }

    .form-section {
      margin-bottom: 20px;
      border-bottom: 1px solid #eee;
      padding-bottom: 20px;
      transition: all 0.3s ease;
    }

    .form-section:hover {
      background-color: #f9f9f9;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .form-group {
      margin-bottom: 15px;
      animation: fadeIn 0.5s ease-out;
    }

    label {
      display: block;
      margin-bottom: 5px;
      font-weight: bold;
      color: #2c3e50;
    }

    select,
    textarea,
    input[type="file"] {
      width: 100%;
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      transition: all 0.3s ease;
    }

    select:focus,
    textarea:focus,
    input[type="file"]:focus {
      border-color: #3498db;
      box-shadow: 0 0 5px rgba(52, 152, 219, 0.5);
    }

    #resolution-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      animation: slideIn 0.7s ease-out;
    }

    #resolution-table th,
    #resolution-table td {
      border: 1px solid #ddd;
      padding: 10px;
      text-align: left;
      transition: background-color 0.3s ease;
    }

    #resolution-table tr:hover {
      background-color: #f1f1f1;
    }

    .action-buttons {
      display: flex;
      justify-content: space-between;
      margin-top: 20px;
    }

    button {
      padding: 10px 15px;
      background-color: #3498db;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.3s ease;
      animation: fadeIn 0.6s ease-out;
      margin-right: 5px;
    }

    button:hover {
      background-color: #2980b9;
      transform: translateY(-3px);
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }

    button.secondary {
      background-color: #95a5a6;
    }

    button.secondary:hover {
      background-color: #7f8c8d;
    }

    .edit-mode select,
    .edit-mode textarea {
      background-color: #eaf2ff;
      border: 2px dashed #3498db;
    }

    .data-section {
      margin-bottom: 20px;
      padding: 15px;
      background-color: #f8f9fa;
      border-radius: 4px;
      border: 1px solid #e9ecef;
    }

    .data-buttons {
      display: flex;
      margin-bottom: 15px;
    }

    .notification {
      padding: 10px;
      margin: 10px 0;
      border-radius: 4px;
      display: none;
    }

    .success {
      background-color: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .error {
      background-color: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
  </style>
</head>

<body>
  <div class="container">
    <h1>ITSM Resolution Selector</h1>
    <div class="form-section">
      <h2>1. Service Category</h2>
      <div class="form-group">
        <label>Service Type</label>
        <select id="service-type">
          <option value="">Select Service Type</option>
          <option value="hardware">Hardware Support</option>
          <option value="software">Software Support</option>
          <option value="network">Network Support</option>
          <option value="access">Access Management</option>
          <option value="email">Email Services</option>
          <option value="security">Security Incident</option>
        </select>
      </div>
    </div>

    <div class="form-section">
      <h2>2. Problem Details</h2>
      <div class="form-group">
        <label>Problem Category</label>
        <select id="problem-category">
          <option value="">Select Problem Category</option>
        </select>
      </div>
      <div class="form-group">
        <label>Specific Issue</label>
        <select id="specific-issue">
          <option value="">Select Specific Issue</option>
        </select>
      </div>
      <div class="form-group">
        <label>Detailed Description</label>
        <textarea id="problem-description" rows="3" placeholder="Provide additional context about the issue"></textarea>
      </div>
    </div>

    <div class="form-section">
      <h2>3. Resolution Steps</h2>
      <div class="form-group">
        <label>Diagnostic Actions</label>
        <select id="diagnostic-actions" multiple>
          <option value="">Select Diagnostic Actions</option>
        </select>
      </div>
      <div class="form-group">
        <label>Resolution Actions</label>
        <select id="resolution-actions" multiple>
          <option value="">Select Resolution Actions</option>
        </select>
      </div>
      <div class="form-group">
        <label>Additional Resolution Notes</label>
        <textarea id="resolution-notes" rows="3" placeholder="Any additional steps or context"></textarea>
      </div>
    </div>

    <div class="form-section">
      <h2>4. Final Result</h2>
      <div class="form-group">
        <label>Resolution Status</label>
        <select id="resolution-status">
          <option value="resolved">Fully Resolved</option>
          <option value="partial">Partially Resolved</option>
          <option value="pending">Pending Further Action</option>
        </select>
      </div>
      <div class="form-group">
        <label>Final Outcome</label>
        <textarea id="final-outcome" rows="3" placeholder="Describe the final result of the resolution"></textarea>
      </div>
      <div class="form-group">
        <label>Technician Information</label>
        <textarea id="resolution-technician" rows="3"
          placeholder="Technician information (name, contact, department)">Nguyễn Hoài Thương (Mr.) - thuong.nh.fpt </textarea>
      </div>
    </div>
    <div class="action-buttons">
      <button id="generate-resolution">Generate Resolution</button>
      <button id="copy-resolution" class="secondary">Copy Resolution</button>
    </div>

    <table id="resolution-table" style="display: none">
      <tbody id="resolution-body">
        <!-- Resolution details will be populated here -->
      </tbody>
    </table>
    <div class="data-section" style="margin-top: 80px;">
      <h2>Resolution Data Management</h2>
      <div class="form-group">
        <label>Import Resolution Data (JSON file)</label>
        <input type="file" id="data-file" accept=".json">
      </div>
      <div class="data-buttons">
        <button id="load-data">Load Data from File</button>
        <button id="export-data" class="secondary">Export Current Data</button>
        <button id="reset-data" class="secondary">Reset to Default Data</button>
      </div>
      <div id="notification" class="notification"></div>
    </div>
  </div>

  <script>
    // Default resolution data
    let resolutionData = {
      hardware: {
        categories: {
          desktop: [
            "Hiệu suất chậm",
            "Màn hình xanh",
            "Không khởi động được",
            "Lỗi phần cứng",
            "Máy tự động tắt",
            "Lỗi ổ cứng",
          ],
          laptop: [
            "Vấn đề pin",
            "Lỗi màn hình",
            "Lỗi bàn phím",
            "Quá nhiệt",
            "Máy treo không phản hồi",
            "Lỗi quạt tản nhiệt",
          ],
          printer: [
            "Kẹt giấy",
            "Chất lượng in kém",
            "Kết nối mạng",
            "Không nhận diện được thiết bị",
            "Máy in không hoạt động",
            "Lỗi hộp mực",
          ],
        },
        diagnosticActions: {
          desktop: [
            "Kiểm tra kết nối nguồn",
            "Chạy công cụ chẩn đoán",
            "Kiểm tra RAM",
            "Kiểm tra cáp kết nối",
            "Kiểm tra nhiệt độ CPU",
            "Chạy kiểm tra ổ cứng",
          ],
          laptop: [
            "Kiểm tra pin",
            "Kiểm tra kết nối màn hình",
            "Chụp ảnh nhiệt",
            "Kiểm tra linh kiện",
            "Vệ sinh quạt tản nhiệt",
            "Chạy kiểm tra phần cứng",
          ],
          printer: [
            "Làm sạch đầu in",
            "Kiểm tra mực/Toner",
            "Chẩn đoán mạng",
            "Kiểm tra đường dẫn giấy",
            "Khởi động lại máy in",
            "Kiểm tra lỗi hộp mực",
          ],
        },
        resolutionActions: {
          desktop: [
            "Khởi động lại máy tính",
            "Cập nhật driver",
            "Thay thế linh kiện",
            "Cài lại hệ điều hành",
            "Nâng cấp RAM",
            "Thay ổ cứng",
          ],
          laptop: [
            "Thay pin",
            "Hàn lại mainboard",
            "Thay màn hình",
            "Làm sạch hệ thống tản nhiệt",
            "Thay quạt làm mát",
            "Thay ổ cứng SSD",
          ],
          printer: [
            "Căn chỉnh lại đầu in",
            "Thay hộp mực",
            "Cài đặt lại mạng",
            "Cập nhật firmware",
            "Thay trống in",
            "Vệ sinh đầu phun",
          ],
        },
      },
      software: {
        categories: {
          office: [
            "Lỗi cài đặt",
            "Vấn đề bản quyền",
            "Hiệu suất",
            "Tương thích",
            "Không thể mở file",
            "Lỗi macro trong Excel",
          ],
          applications: [
            "Cài đặt ứng dụng",
            "Lỗi ứng dụng",
            "Cấu hình",
            "Lỗi truy cập",
            "Xung đột phần mềm",
            "Ứng dụng bị treo",
            "Cài đặt máy in",
            "Cài đặt máy scan",
          ],
        },
        diagnosticActions: {
          office: [
            "Kiểm tra phiên bản",
            "Xác minh bản quyền",
            "Giám sát hiệu suất",
            "Kiểm tra tương thích",
            "Kiểm tra quyền file",
            "Chạy ở chế độ an toàn",
          ],
          applications: [
            "Phân tích nhật ký lỗi",
            "Kiểm tra tương thích hệ thống",
            "Kiểm tra cấu hình",
            "Kiểm tra nhật ký truy cập",
            "Chạy kiểm tra bộ nhớ",
            "Tắt bớt tiến trình chạy nền",
          ],
        },
        resolutionActions: {
          office: [
            "Cài đặt lại phần mềm",
            "Cập nhật bản quyền",
            "Tối ưu hiệu suất",
            "Cập nhật bản vá tương thích",
            "Mở file bằng trình đọc khác",
            "Vô hiệu hóa macro",
          ],
          applications: [
            "Cập nhật bản vá ứng dụng",
            "Cấu hình lại tích hợp",
            "Đặt lại cấu hình",
            "Điều chỉnh quyền truy cập",
            "Khởi động lại dịch vụ nền",
            "Tăng tài nguyên hệ thống",
          ],
        },
      },
      network: {
        categories: {
          slow: ["Mạng chậm", "Lỗi DNS", "Tốc độ tải xuống kém", "Ping cao"],
          disconnect: [
            "Rớt mạng",
            "Không kết nối được Wi-Fi",
            "Lỗi cấu hình mạng",
            "Không thể truy cập VPN",
          ],
        },
        diagnosticActions: {
          slow: [
            "Kiểm tra tốc độ mạng",
            "Phân tích lưu lượng",
            "Kiểm tra tín hiệu Wi-Fi",
            "Kiểm tra cấu hình DNS",
          ],
          disconnect: [
            "Kiểm tra địa chỉ IP",
            "Chẩn đoán cáp mạng",
            "Kiểm tra router/switch",
            "Xem nhật ký kết nối",
          ],
        },
        resolutionActions: {
          slow: [
            "Nâng cấp băng thông",
            "Điều chỉnh QoS",
            "Cập nhật firmware router",
            "Chuyển đổi sang mạng có dây",
          ],
          disconnect: [
            "Đặt lại router",
            "Thay đổi kênh Wi-Fi",
            "Cấu hình lại DNS",
            "Thiết lập lại IP",
          ],
        },
      },
      access: {
        categories: {
          login: [
            "Quên mật khẩu",
            "Tài khoản bị khóa",
            "Không thể đăng nhập",
            "Lỗi xác thực hai yếu tố",
          ],
          permissions: [
            "Sai quyền hạn",
            "Không thể truy cập thư mục",
            "Yêu cầu quyền quản trị",
            "Vấn đề nhóm người dùng",
          ],
        },
        diagnosticActions: {
          login: [
            "Xác minh danh tính người dùng",
            "Kiểm tra trạng thái tài khoản",
            "Kiểm tra hệ thống xác thực",
            "Kiểm tra nhật ký đăng nhập",
          ],
          permissions: [
            "Kiểm tra quyền thư mục",
            "Xem lịch sử thay đổi quyền",
            "Kiểm tra chính sách nhóm",
            "Phân tích lỗi truy cập",
          ],
        },
        resolutionActions: {
          login: [
            "Đặt lại mật khẩu",
            "Mở khóa tài khoản",
            "Cấu hình lại xác thực hai yếu tố",
            "Cấp quyền truy cập tạm thời",
          ],
          permissions: [
            "Cập nhật quyền thư mục",
            "Thêm vào nhóm người dùng phù hợp",
            "Chỉnh sửa chính sách truy cập",
            "Tạo vai trò truy cập mới",
          ],
        },
      },
    };

    // Get references to DOM elements
    const serviceTypeSelect = document.getElementById("service-type");
    const problemCategorySelect = document.getElementById("problem-category");
    const specificIssueSelect = document.getElementById("specific-issue");
    const diagnosticActionsSelect = document.getElementById("diagnostic-actions");
    const resolutionActionsSelect = document.getElementById("resolution-actions");
    const loadDataBtn = document.getElementById("load-data");
    const exportDataBtn = document.getElementById("export-data");
    const resetDataBtn = document.getElementById("reset-data");
    const dataFileInput = document.getElementById("data-file");
    const notification = document.getElementById("notification");

    // Save a copy of default data
    const defaultResolutionData = JSON.parse(JSON.stringify(resolutionData));

    // Function to show notifications
    function showNotification(message, type) {
      notification.textContent = message;
      notification.className = "notification " + type;
      notification.style.display = "block";
      
      // Auto-hide notification after 5 seconds
      setTimeout(() => {
        notification.style.display = "none";
      }, 5000);
    }

    // Function to populate service types dropdown
    function populateServiceTypes() {
      // Keep the first empty option
      serviceTypeSelect.innerHTML = '<option value="">Select Service Type</option>';
      
      // Add options from resolutionData
      Object.keys(resolutionData).forEach(serviceType => {
        const option = document.createElement("option");
        option.value = serviceType;
        
        // Convert service type to title case
        const formattedServiceType = serviceType.charAt(0).toUpperCase() + serviceType.slice(1);
        
        // Add " Support" suffix if not already present
        option.textContent = formattedServiceType.includes("Support") ? 
                            formattedServiceType : 
                            formattedServiceType + " Support";
        serviceTypeSelect.appendChild(option);
      });
    }

    // Load data from file
    loadDataBtn.addEventListener("click", function() {
      const file = dataFileInput.files[0];
      if (!file) {
        showNotification("Please select a JSON file first.", "error");
        return;
      }

      const reader = new FileReader();
      reader.onload = function(e) {
        try {
          const data = JSON.parse(e.target.result);
          
          // Basic validation - check if data has expected structure
          if (!data || typeof data !== 'object') {
            throw new Error("Invalid data format");
          }
          
          // Update the resolution data
          resolutionData = data;
          
          // Update the UI
          populateServiceTypes();
          
          // Reset dependent selections
          resetDependentSelections();
          
          showNotification("Resolution data loaded successfully!", "success");
        } catch (error) {
          console.error("Error parsing JSON:", error);
          showNotification("Error loading data. Please check if the file contains valid JSON.", "error");
        }
      };
      
      reader.readAsText(file);
    });

    // Export current data
    exportDataBtn.addEventListener("click", function() {
      try {
        const dataStr = JSON.stringify(resolutionData, null, 2);
        const dataUri = "data:application/json;charset=utf-8," + encodeURIComponent(dataStr);
        
        const exportLink = document.createElement("a");
        exportLink.setAttribute("href", dataUri);
        exportLink.setAttribute("download", "resolution_data.json");
        document.body.appendChild(exportLink);
        exportLink.click();
        document.body.removeChild(exportLink);
        
        showNotification("Resolution data exported successfully!", "success");
      } catch (error) {
        console.error("Error exporting data:", error);
        showNotification("Error exporting data.", "error");
      }
    });

    // Reset to default data
    resetDataBtn.addEventListener("click", function() {
      resolutionData = JSON.parse(JSON.stringify(defaultResolutionData));
      populateServiceTypes();
      resetDependentSelections();
      showNotification("Reset to default resolution data.", "success");
    });

    // Reset dependent selections
    function resetDependentSelections() {
      problemCategorySelect.innerHTML = '<option value="">Select Problem Category</option>';
      specificIssueSelect.innerHTML = '<option value="">Select Specific Issue</option>';
      diagnosticActionsSelect.innerHTML = '<option value="">Select Diagnostic Actions</option>';
      resolutionActionsSelect.innerHTML = '<option value="">Select Resolution Actions</option>';
    }

    // Initial population of service types
    populateServiceTypes();

    // Service Type change handler
    serviceTypeSelect.addEventListener("change", function() {
      const serviceType = this.value;

      // Reset subsequent dropdowns
      resetDependentSelections();

      if (serviceType && resolutionData[serviceType]) {
        // Populate problem categories
        Object.keys(resolutionData[serviceType].categories).forEach((category) => {
          const option = document.createElement("option");
          option.value = category;
          option.textContent = category.charAt(0).toUpperCase() + category.slice(1);
          problemCategorySelect.appendChild(option);
        });
      }
    });

    // Problem Category change handler
    problemCategorySelect.addEventListener("change", function() {
      const serviceType = serviceTypeSelect.value;
      const problemCategory = this.value;

      // Reset subsequent dropdowns
      specificIssueSelect.innerHTML = '<option value="">Select Specific Issue</option>';
      diagnosticActionsSelect.innerHTML = '<option value="">Select Diagnostic Actions</option>';
      resolutionActionsSelect.innerHTML = '<option value="">Select Resolution Actions</option>';

      if (serviceType && problemCategory) {
        // Populate specific issues
        if (resolutionData[serviceType].categories[problemCategory]) {
          resolutionData[serviceType].categories[problemCategory].forEach((issue) => {
            const option = document.createElement("option");
            option.value = issue;
            option.textContent = issue;
            specificIssueSelect.appendChild(option);
          });
        }

        // Populate diagnostic actions
        if (resolutionData[serviceType].diagnosticActions && 
            resolutionData[serviceType].diagnosticActions[problemCategory]) {
          resolutionData[serviceType].diagnosticActions[problemCategory].forEach((action) => {
            const option = document.createElement("option");
            option.value = action;
            option.textContent = action;
            diagnosticActionsSelect.appendChild(option);
          });
        }

        // Populate resolution actions
        if (resolutionData[serviceType].resolutionActions && 
            resolutionData[serviceType].resolutionActions[problemCategory]) {
          resolutionData[serviceType].resolutionActions[problemCategory].forEach((action) => {
            const option = document.createElement("option");
            option.value = action;
            option.textContent = action;
            resolutionActionsSelect.appendChild(option);
          });
        }
      }
    });

    // Generate Resolution
    document.getElementById("generate-resolution").addEventListener("click", function() {
      const resolutionBody = document.getElementById("resolution-body");
      const resolutionTable = document.getElementById("resolution-table");

      // Clear previous entries
      resolutionBody.innerHTML = "";

      // Collect form data
      const fields = [
        {
          label: "Service Type",
          value: serviceTypeSelect.options[serviceTypeSelect.selectedIndex].text,
        },
        {
          label: "Problem Category",
          value: problemCategorySelect.options[problemCategorySelect.selectedIndex].text,
        },
        {
          label: "Specific Issue",
          value: specificIssueSelect.options[specificIssueSelect.selectedIndex].text,
        },
        {
          label: "Problem Description",
          value: document.getElementById("problem-description").value,
        },
        {
          label: "Diagnostic Actions",
          value: Array.from(diagnosticActionsSelect.selectedOptions)
            .map((option) => option.text)
            .join(", "),
        },
        {
          label: "Resolution Actions",
          value: Array.from(resolutionActionsSelect.selectedOptions)
            .map((option) => option.text)
            .join(", "),
        },
        {
          label: "Resolution Notes",
          value: document.getElementById("resolution-notes").value,
        },
        {
          label: "Resolution Status",
          value: document.getElementById("resolution-status").options[
            document.getElementById("resolution-status").selectedIndex
          ].text,
        },
        {
          label: "Final Outcome",
          value: document.getElementById("final-outcome").value,
        },
        {
          label: "Technician",
          value: document.getElementById("resolution-technician").value,
        },
      ];

      // Populate table
      fields.forEach((field) => {
        if (
          field.value &&
          field.value !== "Select Problem Category" &&
          field.value !== "Select Specific Issue" &&
          field.value !== "Select Service Type"
        ) {
          const row = resolutionBody.insertRow();
          const labelCell = row.insertCell(0);
          const valueCell = row.insertCell(1);
          labelCell.style.fontWeight = "bold";
          labelCell.style.backgroundColor = "#e4e9f2";
          labelCell.style.width = "25%";
          labelCell.textContent = field.label;
          valueCell.textContent = field.value;
        }
      });

      // Show table
      resolutionTable.style.display = "table";
    });

    // Copy Resolution
    document.getElementById("copy-resolution").addEventListener("click", function() {
      const resolutionTable = document.getElementById("resolution-table");
      if (resolutionTable.style.display === "none") {
        showNotification("Please generate a resolution first.", "error");
        return;
      }
      
      const range = document.createRange();
      range.selectNode(resolutionTable);
      window.getSelection().removeAllRanges();
      window.getSelection().addRange(range);

      try {
        document.execCommand("copy");
        showNotification("Resolution copied to clipboard!", "success");
      } catch (err) {
        console.error("Unable to copy", err);
        showNotification("Unable to copy to clipboard.", "error");
      }

      window.getSelection().removeAllRanges();
    });
  </script>
</body>

</html>